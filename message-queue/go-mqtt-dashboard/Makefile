.PHONY: help setup run-broker run-be run-fe stop-broker clean

# ê¸°ë³¸ íƒ€ê²Ÿ
help:
	@echo "MQTT Dashboard - Available Commands"
	@echo "===================================="
	@echo "make setup        - í”„ë¡œì íŠ¸ ì´ˆê¸° ì„¤ì • (ì˜ì¡´ì„± ì„¤ì¹˜)"
	@echo "make run-broker   - Mosquitto ë¸Œë¡œì»¤ ì‹¤í–‰"
	@echo "make run-be       - Backend ì‹¤í–‰"
	@echo "make run-fe       - Frontend ì‹¤í–‰"
	@echo "make stop-broker  - Mosquitto ë¸Œë¡œì»¤ ì¤‘ì§€"
	@echo "make clean        - ì •ë¦¬ (ì»¨í…Œì´ë„ˆ, node_modules ë“±)"

# í”„ë¡œì íŠ¸ ì´ˆê¸° ì„¤ì •
setup:
	@echo "ğŸ“¦ Installing Backend dependencies..."
	cd backend && go mod download
	@echo "ğŸ“¦ Installing Frontend dependencies..."
	cd frontend && npm install
	@echo "âœ… Setup complete!"

# Mosquitto ë¸Œë¡œì»¤ ì‹¤í–‰
run-broker:
	@echo "ğŸš€ Starting Mosquitto broker..."
	docker-compose up -d
	@echo "âœ… Mosquitto running on ports 1883 (MQTT), 9001 (WebSocket)"

# Backend ì‹¤í–‰
run-be:
	@echo "ğŸš€ Starting Backend..."
	cd backend && go run cmd/main.go

# Frontend ì‹¤í–‰
run-fe:
	@echo "ğŸš€ Starting Frontend..."
	cd frontend && npm start

# Mosquitto ë¸Œë¡œì»¤ ì¤‘ì§€
stop-broker:
	@echo "ğŸ›‘ Stopping Mosquitto broker..."
	docker-compose down

# ì •ë¦¬
clean:
	@echo "ğŸ§¹ Cleaning up..."
	docker-compose down -v
	rm -rf frontend/node_modules
	rm -rf backend/vendor
	@echo "âœ… Cleanup complete!"
